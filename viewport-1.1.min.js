!function(e){var t=document,n=window,i={handler:window,delay:200,triggerBefore:0,once:!0,advance:!1,advanceItems:50};e.event.special.viewport={add:function(a,r){var o=e(this),d=e.extend({},i,a.data);d.advance&&o.attr("data-viewport","advance"),e(d.handler).bind("load scroll resize scrollstop",function(i){var a=d.triggerBefore,r=function(e,i){"undefined"!=typeof jQuery&&e instanceof jQuery&&(e=e[0]);var a=e.getBoundingClientRect(),r=n.innerHeight||t.documentElement.clientHeight,o=n.innerWidth||t.documentElement.clientWidth,d=a.top-i<=r&&a.top+a.height>=0,c=a.left<=o&&a.left+a.width>=0;return d&&c}(o,a),c=function(e){"function"==typeof jQuery&&e instanceof jQuery&&(e=e[0]);var i=e.getBoundingClientRect();return i.top>=0&&i.left>=0&&i.bottom<=(n.innerHeight||t.documentElement.clientHeight)&&i.right<=(n.innerWidth||t.documentElement.clientWidth)}(o),l=o.data("once");if(d.once&&!l&&(r||c)){if(o.data("once",!0),o.trigger("viewport",[r,c]),d.advance&&(r||c)){o.removeAttr("data-viewport");o.last();nextSet=e("[data-viewport=advance]").slice(0,d.advanceItems),clearTimeout(e.data(o,"viewport")),e.data(o,"viewport",setTimeout(function(){nextSet.removeAttr("data-viewport"),nextSet.trigger("viewport",[!0,!0])},d.delay))}}else d.once||(clearTimeout(e.data(o,"viewport")),e.data(o,"viewport",setTimeout(function(){if(o.trigger("viewport",[r,c]),d.advance&&(r||c)){var e=o.last();nextSet=e.nextAll().slice(0,d.advanceItems),nextSet.trigger("viewport",[!0,!0])}},d.delay)))})}}}(jQuery);